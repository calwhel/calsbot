             ^^^^^^^^^^^^^
    return self._exec_single_context(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    return meth(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
           ^^^^^
    self._handle_dbapi_exception(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    return connection._execute_clauseelement(
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block
[SQL: SELECT user_preferences.id AS user_preferences_id, user_preferences.user_id AS user_preferences_user_id, user_preferences.muted_symbols AS user_preferences_muted_symbols, user_preferences.default_pnl_period AS user_preferences_default_pnl_period, user_preferences.dm_alerts AS user_preferences_dm_alerts, user_preferences.auto_trading_enabled AS user_preferences_auto_trading_enabled, user_preferences.mexc_api_key AS user_preferences_mexc_api_key, user_preferences.mexc_api_secret AS user_preferences_mexc_api_secret, user_preferences.okx_api_key AS user_preferences_okx_api_key, user_preferences.okx_api_secret AS user_preferences_okx_api_secret, user_preferences.okx_passphrase AS user_preferences_okx_passphrase, user_preferences.kucoin_api_key AS user_preferences_kucoin_api_key, user_preferences.kucoin_api_secret AS user_preferences_kucoin_api_secret, user_preferences.kucoin_passphrase AS user_preferences_kucoin_passphrase, user_preferences.bitunix_api_key AS user_preferences_bitunix_api_key, user_preferences.bitunix_api_secret AS user_preferences_bitunix_api_secret, user_preferences.bitunix_uid AS user_preferences_bitunix_uid, user_preferences.preferred_exchange AS user_preferences_preferred_exchange, user_preferences.position_size_percent AS user_preferences_position_size_percent, user_preferences.position_size_dollars AS user_preferences_position_size_dollars, user_preferences.max_positions AS user_preferences_max_positions, user_preferences.accepted_risk_levels AS user_preferences_accepted_risk_levels, user_preferences.risk_based_sizing AS user_preferences_risk_based_sizing, user_preferences.use_trailing_stop AS user_preferences_use_trailing_stop, user_preferences.trailing_stop_percent AS user_preferences_trailing_stop_percent, user_preferences.use_breakeven_stop AS user_preferences_use_breakeven_stop, user_preferences.daily_loss_limit AS user_preferences_daily_loss_limit, user_preferences.max_drawdown_percent AS user_preferences_max_drawdown_percent, user_preferences.min_balance AS user_preferences_min_balance, user_preferences.max_consecutive_losses AS user_preferences_max_consecutive_losses, user_preferences.cooldown_after_loss AS user_preferences_cooldown_after_loss, user_preferences.emergency_stop AS user_preferences_emergency_stop, user_preferences.safety_paused AS user_preferences_safety_paused, user_preferences.peak_balance AS user_preferences_peak_balance, user_preferences.daily_loss_reset_date AS user_preferences_daily_loss_reset_date, user_preferences.consecutive_losses AS user_preferences_consecutive_losses, user_preferences.last_loss_time AS user_preferences_last_loss_time, user_preferences.news_signals_enabled AS user_preferences_news_signals_enabled, user_preferences.min_news_impact AS user_preferences_min_news_impact, user_preferences.min_news_confidence AS user_preferences_min_news_confidence, user_preferences.tp1_percent AS user_preferences_tp1_percent, user_preferences.tp2_percent AS user_preferences_tp2_percent, user_preferences.tp3_percent AS user_preferences_tp3_percent, user_preferences.user_leverage AS user_preferences_user_leverage, user_preferences.quick_trade_size AS user_preferences_quick_trade_size, user_preferences.trailing_activation_percent AS user_preferences_trailing_activation_percent, user_preferences.trailing_step_percent AS user_preferences_trailing_step_percent, user_preferences.adaptive_sizing_enabled AS user_preferences_adaptive_sizing_enabled, user_preferences.win_streak_multiplier AS user_preferences_win_streak_multiplier, user_preferences.loss_streak_divider AS user_preferences_loss_streak_divider, user_preferences.current_win_streak AS user_preferences_current_win_streak, user_preferences.trade_cooldown_minutes AS user_preferences_trade_cooldown_minutes, user_preferences.max_trades_per_day AS user_preferences_max_trades_per_day, user_preferences.same_symbol_cooldown_minutes AS user_preferences_same_symbol_cooldown_minutes, user_preferences.last_trade_time AS user_preferences_last_trade_time, user_preferences.trades_today AS user_preferences_trades_today, user_preferences.trades_reset_date AS user_preferences_trades_reset_date, user_preferences.last_symbol_trades AS user_preferences_last_symbol_trades, user_preferences.top_gainers_mode_enabled AS user_preferences_top_gainers_mode_enabled, user_preferences.top_gainers_trade_mode AS user_preferences_top_gainers_trade_mode, user_preferences.top_gainers_max_symbols AS user_preferences_top_gainers_max_symbols, user_preferences.top_gainers_min_change AS user_preferences_top_gainers_min_change, user_preferences.top_gainers_leverage AS user_preferences_top_gainers_leverage, user_preferences.top_gainers_win_streak AS user_preferences_top_gainers_win_streak, user_preferences.top_gainers_position_multiplier AS user_preferences_top_gainers_position_multiplier, user_preferences.top_gainers_auto_compound AS user_preferences_top_gainers_auto_compound, user_preferences.metals_enabled AS user_preferences_metals_enabled, user_preferences.metals_leverage AS user_preferences_metals_leverage, user_preferences.metals_position_size_percent AS user_preferences_metals_position_size_percent, user_preferences.metals_position_size_dollars AS user_preferences_metals_position_size_dollars, user_preferences.metals_max_positions AS user_preferences_metals_max_positions, user_preferences.social_mode_enabled AS user_preferences_social_mode_enabled, user_preferences.social_leverage AS user_preferences_social_leverage, user_preferences.social_top_coin_leverage AS user_preferences_social_top_coin_leverage, user_preferences.social_position_size_percent AS user_preferences_social_position_size_percent, user_preferences.social_position_size_dollars AS user_preferences_social_position_size_dollars, user_preferences.social_max_positions AS user_preferences_social_max_positions, user_preferences.social_min_galaxy_score AS user_preferences_social_min_galaxy_score, user_preferences.social_risk_level AS user_preferences_social_risk_level, user_preferences.social_size_low AS user_preferences_social_size_low, user_preferences.social_size_medium AS user_preferences_social_size_medium, user_preferences.social_size_high AS user_preferences_social_size_high, user_preferences.social_size_all AS user_preferences_social_size_all, user_preferences.news_trading_enabled AS user_preferences_news_trading_enabled, user_preferences.news_leverage AS user_preferences_news_leverage, user_preferences.news_top_coin_leverage AS user_preferences_news_top_coin_leverage, user_preferences.news_position_size_percent AS user_preferences_news_position_size_percent, user_preferences.news_risk_level AS user_preferences_news_risk_level, user_preferences.news_max_positions AS user_preferences_news_max_positions, user_preferences.market_condition_adaptive AS user_preferences_market_condition_adaptive, user_preferences.volatility_threshold_high AS user_preferences_volatility_threshold_high, user_preferences.volatility_threshold_low AS user_preferences_volatility_threshold_low, user_preferences.high_volatility_size_reduction AS user_preferences_high_volatility_size_reduction, user_preferences.use_limit_orders AS user_preferences_use_limit_orders, user_preferences.entry_slippage_percent AS user_preferences_entry_slippage_percent, user_preferences.limit_order_timeout_seconds AS user_preferences_limit_order_timeout_seconds, user_preferences.rr_scaling_enabled AS user_preferences_rr_scaling_enabled, user_preferences.min_rr_for_full_size AS user_preferences_min_rr_for_full_size, user_preferences.rr_scaling_multiplier AS user_preferences_rr_scaling_multiplier, user_preferences.correlation_filter_enabled AS user_preferences_correlation_filter_enabled, user_preferences.max_correlated_positions AS user_preferences_max_correlated_positions, user_preferences.funding_rate_alerts_enabled AS user_preferences_funding_rate_alerts_enabled, user_preferences.funding_rate_threshold AS user_preferences_funding_rate_threshold, user_preferences.scalp_mode_enabled AS user_preferences_scalp_mode_enabled, user_preferences.scalp_position_size_percent AS user_preferences_scalp_position_size_percent, user_preferences.squeeze_mode_enabled AS user_preferences_squeeze_mode_enabled, user_preferences.supertrend_mode_enabled AS user_preferences_supertrend_mode_enabled, user_preferences.macd_mode_enabled AS user_preferences_macd_mode_enabled 
FROM user_preferences 
WHERE %(param_1)s = user_prefe